{% extends "admin/_base.html" %}
{% from "_macros/cpes.html" import cpe_components %}
{% from "_macros/time.html" import format_absolute_time, timezone_abbr %}

{% block title %}Recent unmatched CVEs - Repology{% endblock %}
{% block header %}Recent unmatched CVEs{% endblock %}

{% block content %}
<div class="container">

<p>This is the list of recently modified CVEs which were not matched to Repology projects. While most
of these are commecial products not packaged anywhere, some of these are good projects which miss CPE
bindings, and these are important to add as Repology wants these recent CVEs to be visible to packagers
as soon as possible. Please recheck that CVEs actually apply to the named projects before adding, the
guess is dumb and uses simple name match, so there may be unrelated projects with the same name. Likewise,
entries without guessed project may be valid as well - for these you'll have to add CPE binding manually.</p>

<p><b>{{ items|length }}</b> item(s) shown</p>

<table class="table table-striped">
	<thead>
		<tr>
			<th>Last modified{{ timezone_abbr() }}</th>
			<th>CPE</th>
			<th>CVE(s)</th>
			<th>Candidates</th>
		</tr>
	</thead>
	<tbody>
	{% for item in items %}
		<tr>
			<td class="minimal-column">{{ format_absolute_time(item.last_modified) }}</td>
			<td>{{ cpe_components(item) }}</td>
			<td>
			{%- for cve_id in item.cve_ids -%}
				<a href="https://nvd.nist.gov/vuln/detail/{{ cve_id }}">{{ cve_id }}</a>
			{% endfor -%}
			</td>
			<td class="minimal-column">
			{% if item.project_candidates %}
			{% for effname in item.project_candidates %}
				{% if not loop.first %}<br>{% endif %}
				<a href="{{ url_for(endpoint='project_versions', name=effname ) }}">{{ effname }}</a>
				<form class="form-inlinest" action="{{ url_for_self() }}" method="POST">
					<input type="hidden" name="effname" value="{{ effname }}">
					<input type="hidden" name="cpe_vendor" value="{{ item.cpe_vendor }}">
					<input type="hidden" name="cpe_product" value="{{ item.cpe_product }}">
					<input type="hidden" name="cpe_edition" value="{{ item.cpe_edition }}">
					<input type="hidden" name="cpe_lang" value="{{ item.cpe_lang }}">
					<input type="hidden" name="cpe_sw_edition" value="{{ item.cpe_sw_edition }}">
					<input type="hidden" name="cpe_target_sw" value="{{ item.cpe_target_sw }}">
					<input type="hidden" name="cpe_target_hw" value="{{ item.cpe_target_hw }}">
					<input type="hidden" name="cpe_other" value="{{ item.cpe_other }}">
					<button type="submit" class="btn btn-warning btn-xs" name="action" value="add">Add</button>
					<button type="submit" class="btn btn-warning btn-xs" name="action" value="autoadd">Autoadd</button>
				</form>
			{% endfor %}
			{%- else -%}
				-
			{%- endif -%}
			</td>
		</tr>
	{% endfor %}
	</tbody>
</table>

</div>
{% endblock %}
